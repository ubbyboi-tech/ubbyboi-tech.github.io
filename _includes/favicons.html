<!-- Favicons -->
<link
  rel="apple-touch-icon"
  sizes="180x180"
  href="{{ '/assets/img/favicons/favicon-512x512.png' | relative_url }}"
/>
<link
  rel="icon"
  type="image/png"
  sizes="32x32"
  href="{{ '/assets/img/favicons/favicon-32x32.png' | relative_url }}"
/>
<link
  rel="icon"
  type="image/png"
  sizes="16x16"
  href="{{ '/assets/img/favicons/favicon-16x16.png' | relative_url }}"
/>
<link
  rel="shortcut icon"
  href="{{ '/assets/img/favicons/favicon.ico' | relative_url }}"
/>
<link rel="icon" href="{{ '/favicon.ico' | relative_url }}" />

<!-- GLightbox Fix - Prevent Navigation and Open Lightbox -->
<script>
  (function () {
    // CRITICAL: Prevent ALL navigation on .glightbox links
    function setupGLightbox() {
      // Remove href to prevent navigation, store it in data attribute instead
      document.querySelectorAll("a.glightbox").forEach(function (link) {
        const href = link.getAttribute("href");
        if (href && !link.hasAttribute("data-glightbox-href")) {
          link.setAttribute("data-glightbox-href", href);
          link.setAttribute("href", "javascript:void(0)");
        }
      });

      // Global click handler - MUST run first (capture phase)
      document.addEventListener(
        "click",
        function (e) {
          const link = e.target.closest("a.glightbox");
          if (link) {
            e.preventDefault();
            e.stopPropagation();
            e.stopImmediatePropagation();

            const imageUrl =
              link.getAttribute("data-glightbox-href") ||
              link.getAttribute("href");

            // Wait for GLightbox to be available
            if (typeof GLightbox !== "undefined") {
              if (!window.glightboxInstance) {
                window.glightboxInstance = GLightbox({
                  selector: ".glightbox",
                  closeButton: true,
                  closeOnOutsideClick: true,
                  touchNavigation: true,
                  keyboardNavigation: true,
                });
              }
              if (imageUrl && imageUrl !== "javascript:void(0)") {
                window.glightboxInstance.open(imageUrl);
              }
            }

            return false;
          }
        },
        true
      ); // Capture phase - runs BEFORE other handlers
    }

    // Run immediately
    setupGLightbox();

    // Run when DOM is ready
    if (document.readyState === "loading") {
      document.addEventListener("DOMContentLoaded", setupGLightbox);
    }

    // Run after everything loads
    window.addEventListener("load", function () {
      setTimeout(setupGLightbox, 50);
      setTimeout(setupGLightbox, 200);
      setTimeout(setupGLightbox, 500);
    });
  })();
</script>
